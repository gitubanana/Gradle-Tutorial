## Running Gradle Tasks

### Step 1. Viewing available Tasks
`task`는 일의 기본 단위이다.
Gradle에 의해서 빌드의 일부분으로 수행될 수 있다.<br>
`.\gradlew.bat build` 명령어도 build라는 `task`를 수행한 것이다.<br>


아래 명령어를 통해서 `task`의 목록을 볼 수 있다.<br>
```powershell
.\gradlew.bat tasks            # 가능한 task 목록 보기
.\gradlew.bat tasks --all      # task관련 더 많은 정보 보기 
.\gradlew.bat tasks :app:tasks # 서브프로젝트app의 task 목록 보기
```

### Step 2. Understanding Tasks
프로젝트가 초기의 `task`는 봤는데, 우리만의 `task`는 만들 수 없을까?<br>
Gradle은 많은 built-in task를 제공해, 개발자가 build script를 향상시킬 수 있다.<br>

아래 `task`는 built-in task인 `Copy`를 이용해 `source`디렉터리에 있는 `*.war`파일을 `target`디렉터리로 복사한다.<br>
```groovy
tasks.register("copyTask", copy) {
    from("source")
    into("target")
    include("*.war")
}
```
서브프로젝트`app`의 `build.gradle`에 추가하면, `.\gradlew.bat :app:copyTask`명령어로 실행할 수 있다.<br>
> 참고로, tutorial에선 "CopyTask"와 copy 순서가 바꿔져있다... 그래서, [issue](https://github.com/gradle/gradle/issues/30813)를 올려봤다.<br>
> 또한, app디렉터리 안에 있는 source에서 target으로 복사가 이루어진다.
- **유명한 built-in task**<br>
  `Copy` - 파일을 복사할 수 있다.<br>
  `Delete` - 파일과 디렉터리를 삭제한다.<br>
  `Exec` - 임의의 OS명령어를 실행한다.<br>
  `Zip` - 파일을 묶을 때 사용한다.<br>

### Step 3. Understanding Dependencies Between Tasks
A task를 하고, B task를 하고 싶으면 dependency를 정해주면 된다.<br>
```groovy
tasks.register("hello") {
    doLast {
        println('Hello!')
    }
}

tasks.register("greet") {
    doLast {
        println('How are you?')
    }
    dependsOn("hello")
}
```
> `.\gradlew.bat :app:greet`를 실행시키면, hello task가 실행되고, greet task가 실행되어서 Hello!\nHow are you?\n가 출력된다.

task 실행 순서는 Gradle에 의해 자동으로 결정된다.<br>
Gradle은 사용자에게 특정 순서를 받을 수도 있다.<br>

### Step 6. Running Tasks in the Terminal
> intellij에서는 오른쪽 패널에서 gradle을 열어, build를 더블클릭해 빌드시킬 수 있다.
```powershell
.\gradlew.bat build          # 소스코드와 의존성을 이용해 앱을 빌드한다. (compile, assemble, test, check 등을 한다.)
> Task :app:compileJava      # task가 실행 순서에 따라 출력된다.
> Task :app:processResources
> Task :app:classes
> Task :app:jar
> Task :app:startScripts
> Task :app:distTar
> Task :app:distZip
> Task :app:assemble
> Task :app:compileTestJava
> Task :app:processTestResources
> Task :app:testClasses
> Task :app:test
> Task :app:check
> Task :app:build
```
`build` task 실행.<br>

```powershell
.\gradlew.bat jar
> Task :app:compileJava      # build task의 맨 처음 실행된다.
> Task :app:processResources
> Task :app:classes
> Task :app:jar
```
`jar` task는 `build` task의 dependency이다.<br>
(`jar` task는 `build` task보다 먼저 실행된다.)<br>
`jar` task가 끝나면, `app.jar`이 `app/build/libs`디렉터리에 생성된다.<br>

```powershell
.\gradlew.bat run
> Task :app:compileJava
> Task :app:processResources
> Task :app:classes

> Task :app:run
Hello World!

BUILD SUCCESSFUL in 325ms
```
`run` task를 싱행시키면, `app/src/main/java/org.example/App.java`에 있는 코드를 실행시킨다.<br>
```java
/*
 * This source file was generated by the Gradle 'init' task
 */
package org.example;

public class App {
    public String getGreeting() {
        return "Hello World!";
    }

    public static void main(String[] args) {
        System.out.println(new App().getGreeting());
    }
}
```

### Reference
[Part 2: Running Gradle Tasks](https://docs.gradle.org/current/userguide/part2_gradle_tasks.html#part2_begin)<br>
